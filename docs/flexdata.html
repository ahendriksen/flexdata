

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>flexdata package &mdash; flexdata  documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Changelog" href="changelog.html" />
    <link rel="prev" title="flexDATA" href="readme.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> flexdata
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="readme.html">flexDATA</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">flexdata package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-flexdata.array">flexdata.array module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-flexdata.display">flexdata.display module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-flexdata.io">flexdata.io module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-flexdata.scp">flexdata.scp module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-flexdata">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">flexdata</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>flexdata package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/flexdata.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="flexdata-package">
<h1>flexdata package<a class="headerlink" href="#flexdata-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-flexdata.array">
<span id="flexdata-array-module"></span><h2>flexdata.array module<a class="headerlink" href="#module-flexdata.array" title="Permalink to this headline">¶</a></h2>
<p>&#64;author: kostenko
Created on Oct 2018</p>
<p>Utility functions to hande big arrays of data. All routines support memmap arrays.
However, some operations will need enough memory for one copy of the data for intermediate
results. This can be improved through better use of memmaps.</p>
<dl class="function">
<dt id="flexdata.array.add_dim">
<code class="descclassname">flexdata.array.</code><code class="descname">add_dim</code><span class="sig-paren">(</span><em>array_1</em>, <em>array_2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/array.html#add_dim"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.array.add_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Add two arrays with arbitrary dimensions. We assume that one or two dimensions match.</p>
</dd></dl>

<dl class="function">
<dt id="flexdata.array.anyslice">
<code class="descclassname">flexdata.array.</code><code class="descname">anyslice</code><span class="sig-paren">(</span><em>array</em>, <em>index</em>, <em>dim</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/array.html#anyslice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.array.anyslice" title="Permalink to this definition">¶</a></dt>
<dd><p>Slice an array along an arbitrary dimension.</p>
</dd></dl>

<dl class="function">
<dt id="flexdata.array.bin">
<code class="descclassname">flexdata.array.</code><code class="descname">bin</code><span class="sig-paren">(</span><em>array</em>, <em>dim=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/array.html#bin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.array.bin" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple binning of the data along the chosen direction.</p>
</dd></dl>

<dl class="function">
<dt id="flexdata.array.cast2shape">
<code class="descclassname">flexdata.array.</code><code class="descname">cast2shape</code><span class="sig-paren">(</span><em>array</em>, <em>shape</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/array.html#cast2shape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.array.cast2shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Make the array to conform with the given shape.</p>
</dd></dl>

<dl class="function">
<dt id="flexdata.array.cast2type">
<code class="descclassname">flexdata.array.</code><code class="descname">cast2type</code><span class="sig-paren">(</span><em>array</em>, <em>dtype</em>, <em>bounds=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/array.html#cast2type"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.array.cast2type" title="Permalink to this definition">¶</a></dt>
<dd><p>Cast from float to int or float to float rescaling values if needed.</p>
</dd></dl>

<dl class="function">
<dt id="flexdata.array.crop">
<code class="descclassname">flexdata.array.</code><code class="descname">crop</code><span class="sig-paren">(</span><em>array</em>, <em>dim</em>, <em>width</em>, <em>geometry=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/array.html#crop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.array.crop" title="Permalink to this definition">¶</a></dt>
<dd><p>Crop an array along the given dimension. Provide geometry if cropping the projection data,
it will update the detector center.</p>
</dd></dl>

<dl class="function">
<dt id="flexdata.array.detector_bounds">
<code class="descclassname">flexdata.array.</code><code class="descname">detector_bounds</code><span class="sig-paren">(</span><em>shape</em>, <em>geometry</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/array.html#detector_bounds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.array.detector_bounds" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the boundaries of the detector in mm</p>
</dd></dl>

<dl class="function">
<dt id="flexdata.array.detector_size">
<code class="descclassname">flexdata.array.</code><code class="descname">detector_size</code><span class="sig-paren">(</span><em>shape</em>, <em>geometry</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/array.html#detector_size"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.array.detector_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the size of detector in mm.</p>
</dd></dl>

<dl class="function">
<dt id="flexdata.array.divergence">
<code class="descclassname">flexdata.array.</code><code class="descname">divergence</code><span class="sig-paren">(</span><em>array, axes=[0, 1, 2]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/array.html#divergence"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.array.divergence" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="flexdata.array.free_memory">
<code class="descclassname">flexdata.array.</code><code class="descname">free_memory</code><span class="sig-paren">(</span><em>percent=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/array.html#free_memory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.array.free_memory" title="Permalink to this definition">¶</a></dt>
<dd><p>Return amount of free memory in GB.
Args:</p>
<blockquote>
<div>percent (bool): percentage of the total or in GB.</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="flexdata.array.gradient">
<code class="descclassname">flexdata.array.</code><code class="descname">gradient</code><span class="sig-paren">(</span><em>array, axes=[0, 1, 2]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/array.html#gradient"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.array.gradient" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="flexdata.array.medipix2astra">
<code class="descclassname">flexdata.array.</code><code class="descname">medipix2astra</code><span class="sig-paren">(</span><em>array</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/array.html#medipix2astra"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.array.medipix2astra" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a given numpy array (sorted: index, hor, vert) to ASTRA-compatible projections stack</p>
</dd></dl>

<dl class="class">
<dt id="flexdata.array.memmap">
<em class="property">class </em><code class="descclassname">flexdata.array.</code><code class="descname">memmap</code><a class="reference internal" href="_modules/flexdata/array.html#memmap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.array.memmap" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.core.memmap.memmap</span></code></p>
<p>Standard memmaps don’t seem to reliably delete files that are created on disk.
This fixes it…</p>
<dl class="method">
<dt id="flexdata.array.memmap.delete">
<code class="descname">delete</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/array.html#memmap.delete"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.array.memmap.delete" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="flexdata.array.mult_dim">
<code class="descclassname">flexdata.array.</code><code class="descname">mult_dim</code><span class="sig-paren">(</span><em>array_1</em>, <em>array_2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/array.html#mult_dim"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.array.mult_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiply a 3D array by a 1D or a 2D vector along one of the dimensions.</p>
</dd></dl>

<dl class="function">
<dt id="flexdata.array.pad">
<code class="descclassname">flexdata.array.</code><code class="descname">pad</code><span class="sig-paren">(</span><em>array</em>, <em>dim</em>, <em>width</em>, <em>mode='edge'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/array.html#pad"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.array.pad" title="Permalink to this definition">¶</a></dt>
<dd><p>Pad an array along a given dimension.</p>
<p>numpy.pad seems to be very memory hungry! Don’t use it for large arrays.</p>
</dd></dl>

<dl class="function">
<dt id="flexdata.array.ramp">
<code class="descclassname">flexdata.array.</code><code class="descname">ramp</code><span class="sig-paren">(</span><em>array</em>, <em>dim</em>, <em>width</em>, <em>mode='linear'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/array.html#ramp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.array.ramp" title="Permalink to this definition">¶</a></dt>
<dd><p>Create ramps at the ends of the array (without changing its size). 
modes:</p>
<blockquote>
<div>‘linear’ - creates linear decay of intensity
‘edge’ - smears data in a costant manner
‘zero’ - sets values to zeroes</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="flexdata.array.raw2astra">
<code class="descclassname">flexdata.array.</code><code class="descname">raw2astra</code><span class="sig-paren">(</span><em>array</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/array.html#raw2astra"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.array.raw2astra" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a given numpy array (sorted: index, hor, vert) to ASTRA-compatible projections stack</p>
</dd></dl>

<dl class="function">
<dt id="flexdata.array.rewrite_memmap">
<code class="descclassname">flexdata.array.</code><code class="descname">rewrite_memmap</code><span class="sig-paren">(</span><em>old_array</em>, <em>new_array</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/array.html#rewrite_memmap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.array.rewrite_memmap" title="Permalink to this definition">¶</a></dt>
<dd><p>Reshaping memmaps is tough. We will recreate one instead hoping that this will not overflow our RAM…
This is a dirty qick fix! Try to use resize instead!</p>
</dd></dl>

<dl class="function">
<dt id="flexdata.array.shape_alike">
<code class="descclassname">flexdata.array.</code><code class="descname">shape_alike</code><span class="sig-paren">(</span><em>array_1</em>, <em>array_2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/array.html#shape_alike"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.array.shape_alike" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Make sure two arrays have the same shape by padding either array_1 or array_2:</dt>
<dd>Returns: array1, array2 - reshaped.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="flexdata.array.shift_geometry">
<code class="descclassname">flexdata.array.</code><code class="descname">shift_geometry</code><span class="sig-paren">(</span><em>geometry</em>, <em>hrz</em>, <em>vrt</em>, <em>update_volume_pos=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/array.html#shift_geometry"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.array.shift_geometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply geometry shift in pixels.</p>
</dd></dl>

<dl class="function">
<dt id="flexdata.array.tiles_shape">
<code class="descclassname">flexdata.array.</code><code class="descname">tiles_shape</code><span class="sig-paren">(</span><em>shape</em>, <em>geometry_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/array.html#tiles_shape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.array.tiles_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the size of the stiched dataset.
Args:</p>
<blockquote>
<div>shape: shape of a single projection stack.
geometry_list: list of geometries.</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="flexdata.array.volume_bounds">
<code class="descclassname">flexdata.array.</code><code class="descname">volume_bounds</code><span class="sig-paren">(</span><em>proj_shape</em>, <em>geometry</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/array.html#volume_bounds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.array.volume_bounds" title="Permalink to this definition">¶</a></dt>
<dd><p>A very simplified version of volume bounds…</p>
</dd></dl>

<dl class="function">
<dt id="flexdata.array.volume_shape">
<code class="descclassname">flexdata.array.</code><code class="descname">volume_shape</code><span class="sig-paren">(</span><em>proj_shape</em>, <em>geometry</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/array.html#volume_shape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.array.volume_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Based on physical volume bnounds compute shape in pixels:</p>
</dd></dl>

</div>
<div class="section" id="module-flexdata.display">
<span id="flexdata-display-module"></span><h2>flexdata.display module<a class="headerlink" href="#module-flexdata.display" title="Permalink to this headline">¶</a></h2>
<p>Created on Oct 2018
&#64;author: kostenko</p>
<p>Few simple reoutines for displaying 3D data (memmap-compatible).</p>
<dl class="function">
<dt id="flexdata.display.max_projection">
<code class="descclassname">flexdata.display.</code><code class="descname">max_projection</code><span class="sig-paren">(</span><em>data</em>, <em>dim=0</em>, <em>bounds=None</em>, <em>title=None</em>, <em>cmap='gray'</em>, <em>file=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/display.html#max_projection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.display.max_projection" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="flexdata.display.mesh">
<code class="descclassname">flexdata.display.</code><code class="descname">mesh</code><span class="sig-paren">(</span><em>stl_mesh</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/display.html#mesh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.display.mesh" title="Permalink to this definition">¶</a></dt>
<dd><p>Display an stl mesh. Use flexCompute.generate_stl(volume) to generate mesh.</p>
</dd></dl>

<dl class="function">
<dt id="flexdata.display.min_projection">
<code class="descclassname">flexdata.display.</code><code class="descname">min_projection</code><span class="sig-paren">(</span><em>data</em>, <em>dim=0</em>, <em>title=None</em>, <em>cmap='gray'</em>, <em>file=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/display.html#min_projection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.display.min_projection" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="flexdata.display.plot">
<code class="descclassname">flexdata.display.</code><code class="descname">plot</code><span class="sig-paren">(</span><em>x</em>, <em>y=None</em>, <em>semilogy=False</em>, <em>title=None</em>, <em>legend=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/display.html#plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.display.plot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="flexdata.display.projection">
<code class="descclassname">flexdata.display.</code><code class="descname">projection</code><span class="sig-paren">(</span><em>data</em>, <em>dim=1</em>, <em>bounds=None</em>, <em>title=None</em>, <em>cmap='gray'</em>, <em>file=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/display.html#projection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.display.projection" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="flexdata.display.pyqt_graph">
<code class="descclassname">flexdata.display.</code><code class="descname">pyqt_graph</code><span class="sig-paren">(</span><em>data</em>, <em>dim=0</em>, <em>title=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/display.html#pyqt_graph"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.display.pyqt_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a PYQT window to display a 3D dataset.</p>
</dd></dl>

<dl class="function">
<dt id="flexdata.display.slice">
<code class="descclassname">flexdata.display.</code><code class="descname">slice</code><span class="sig-paren">(</span><em>data</em>, <em>index=None</em>, <em>dim=0</em>, <em>bounds=None</em>, <em>title=None</em>, <em>cmap='gray'</em>, <em>file=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/display.html#slice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.display.slice" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-flexdata.io">
<span id="flexdata-io-module"></span><h2>flexdata.io module<a class="headerlink" href="#module-flexdata.io" title="Permalink to this headline">¶</a></h2>
<p>&#64;author: kostenko
Created on Oct 2018</p>
<p>This module will contain read / write routines to convert FlexRay scanner data into ASTRA compatible data</p>
<dl class="docutils">
<dt>We can now read/write:</dt>
<dd>image files (tiff stacks)
log files from Flex ray (settings.txt)
toml geometry files (metadata.toml)</dd>
</dl>
<p>We can also copy data over SCP!</p>
<dl class="function">
<dt id="flexdata.io.astra_proj_geom">
<code class="descclassname">flexdata.io.</code><code class="descname">astra_proj_geom</code><span class="sig-paren">(</span><em>geometry</em>, <em>data_shape</em>, <em>index=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/io.html#astra_proj_geom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.io.astra_proj_geom" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the vector that describes positions of the source and detector.
Works with three types of geometry: simple, static_offsets, linear_offsets.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>geometry  : geometry record of one of three types
data_shape: [detector_count_z, theta_count, detector_count_x]
index     : if provided - sequence of the rotation angles</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="flexdata.io.astra_vol_geom">
<code class="descclassname">flexdata.io.</code><code class="descname">astra_vol_geom</code><span class="sig-paren">(</span><em>geometry</em>, <em>vol_shape</em>, <em>slice_first=None</em>, <em>slice_last=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/io.html#astra_vol_geom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.io.astra_vol_geom" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize ASTRA volume geometry.</p>
</dd></dl>

<dl class="function">
<dt id="flexdata.io.free_memory">
<code class="descclassname">flexdata.io.</code><code class="descname">free_memory</code><span class="sig-paren">(</span><em>percent=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/io.html#free_memory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.io.free_memory" title="Permalink to this definition">¶</a></dt>
<dd><p>Return amount of free memory in GB.
Args:</p>
<blockquote>
<div>percent (bool): percentage of the total or in GB.</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="flexdata.io.init_geometry">
<code class="descclassname">flexdata.io.</code><code class="descname">init_geometry</code><span class="sig-paren">(</span><em>src2obj=0, det2obj=0, det_pixel=0, unit='millimetre', theta_range=[0, 360], geom_type='simple'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/io.html#init_geometry"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.io.init_geometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the geometry record with a basic geometry records.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>src2obj     : source to object distance
det2obj     : detector to object distance
det_pixel   : detector pixel size
unit        : metric unit
theta_range : range of rotation
geom_type   : can be ‘simple’, ‘static_offsets’ or ‘linear_offsets’</dd>
<dt>Returns: </dt>
<dd>geometry: a dictionary containing records of one of three types of the geometry.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="flexdata.io.init_meta">
<code class="descclassname">flexdata.io.</code><code class="descname">init_meta</code><span class="sig-paren">(</span><em>geometry=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/io.html#init_meta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.io.init_meta" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the meta record (contains: geometry, settings and description).</p>
</dd></dl>

<dl class="function">
<dt id="flexdata.io.mm2pixel">
<code class="descclassname">flexdata.io.</code><code class="descname">mm2pixel</code><span class="sig-paren">(</span><em>value</em>, <em>geometry</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/io.html#mm2pixel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.io.mm2pixel" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert millimetres to pixels by dividing the value by img_pixel</p>
</dd></dl>

<dl class="function">
<dt id="flexdata.io.pixel2mm">
<code class="descclassname">flexdata.io.</code><code class="descname">pixel2mm</code><span class="sig-paren">(</span><em>value</em>, <em>geometry</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/io.html#pixel2mm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.io.pixel2mm" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert pixels to millimetres by multiplying the value by img_pixel</p>
</dd></dl>

<dl class="function">
<dt id="flexdata.io.read_flexray">
<code class="descclassname">flexdata.io.</code><code class="descname">read_flexray</code><span class="sig-paren">(</span><em>path</em>, <em>sample=1</em>, <em>skip=1</em>, <em>memmap=None</em>, <em>proj_number=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/io.html#read_flexray"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.io.read_flexray" title="Permalink to this definition">¶</a></dt>
<dd><p>Read raw projecitions, dark and flat-field, scan parameters from a typical FlexRay folder.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>path   (str): path to flexray data.
skip   (int): read every ## image
sample (int): keep every ## x ## pixel
memmap (str): output a memmap array using the given path
proj_number (int): force projection number (treat lesser numbers as missing)</dd>
<dt>Returns:</dt>
<dd>proj (numpy.array): projections stack
flat (numpy.array): reference flat field images
dark (numpy.array): dark field images   
meta (dict): description of the geometry, physical settings and comments</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="flexdata.io.read_image">
<code class="descclassname">flexdata.io.</code><code class="descname">read_image</code><span class="sig-paren">(</span><em>file</em>, <em>sample=1</em>, <em>x_roi=[]</em>, <em>y_roi=[]</em>, <em>shape=None</em>, <em>format=None</em>, <em>dtype=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/io.html#read_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.io.read_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a single image. Use sampling and roi parameters to reduce the array size. 
Use shape, format and dtype to force file reading settings.</p>
</dd></dl>

<dl class="function">
<dt id="flexdata.io.read_meta">
<code class="descclassname">flexdata.io.</code><code class="descname">read_meta</code><span class="sig-paren">(</span><em>path</em>, <em>meta_type='flexray'</em>, <em>sample=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/io.html#read_meta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.io.read_meta" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the log file and return dictionaries with parameters of the scan.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>path (str): path to the files location
meta_type (str): type of the meta file: ‘flexray’ (read settings file), ‘metadata’ (meta script output) or ‘toml’ (raw meta record saved in toml format).</dd>
<dt>Returns:    </dt>
<dd>geometry : src2obj, det2obj, det_pixel, thetas, det_hrz, det_vrt, det_mag, det_roll, src_hrz, src_vrt, src_mag, axs_hrz, vol_hrz, vol_tra 
settings : physical settings - voltage, current, exposure
description : lyrical description of the data</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="flexdata.io.read_stack">
<code class="descclassname">flexdata.io.</code><code class="descname">read_stack</code><span class="sig-paren">(</span><em>path</em>, <em>name</em>, <em>skip=1</em>, <em>sample=1</em>, <em>x_roi=[]</em>, <em>y_roi=[]</em>, <em>shape=None</em>, <em>dtype=None</em>, <em>format=None</em>, <em>flipdim=False</em>, <em>memmap=None</em>, <em>success=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/io.html#read_stack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.io.read_stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Read stack of files and return a numpy array.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>path (str): path to the files location
name (str): common part of the files name
skip (int): read every so many files
sample (int): sampling factor in x/y direction
x_roi ([x0, x1]): horizontal range
y_roi ([y0, y1]): vertical range
shape (array): shape of the files. Use it when the format is ‘raw’.
dtype (str or numpy.dtype): data type of the files
format (str): file format (‘tif’, ‘raw’, etc)
flipdim (bool): apply dimension switch for ASTRA compatibility
memmap (str): if provided, return a disk mapped array to save RAM
success(array): map of the files that could be loaded (equals 0 in case of a read failure)</dd>
<dt>Returns:</dt>
<dd>numpy.array : 3D array with the first dimension representing the image index</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="flexdata.io.read_tiffs">
<code class="descclassname">flexdata.io.</code><code class="descname">read_tiffs</code><span class="sig-paren">(</span><em>path</em>, <em>name</em>, <em>skip=1</em>, <em>sample=1</em>, <em>x_roi=[]</em>, <em>y_roi=[]</em>, <em>dtype=None</em>, <em>flipdim=False</em>, <em>memmap=None</em>, <em>success=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/io.html#read_tiffs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.io.read_tiffs" title="Permalink to this definition">¶</a></dt>
<dd><p>Read tiff files stack and return a numpy array.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>path (str): path to the files location
name (str): common part of the files name
skip (int): read every so many files
sample (int): sampling factor in x/y direction
x_roi ([x0, x1]): horizontal range
y_roi ([y0, y1]): vertical range
dtype (str or numpy.dtype): data type to return
flipdim (bool): apply dimension switch for ASTRA compatibility
memmap (str): if provided, return a disk mapped array to save RAM
success(array): map of the files that could be loaded (equals 0 in case of a read failure)</dd>
<dt>Returns:</dt>
<dd>numpy.array : 3D array with the first dimension representing the image index</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="flexdata.io.read_toml">
<code class="descclassname">flexdata.io.</code><code class="descname">read_toml</code><span class="sig-paren">(</span><em>file_path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/io.html#read_toml"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.io.read_toml" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a toml file.</p>
</dd></dl>

<dl class="function">
<dt id="flexdata.io.unit_to_mm">
<code class="descclassname">flexdata.io.</code><code class="descname">unit_to_mm</code><span class="sig-paren">(</span><em>meta</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/io.html#unit_to_mm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.io.unit_to_mm" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a meta record to standard units (mm).</p>
</dd></dl>

<dl class="function">
<dt id="flexdata.io.write_astra">
<code class="descclassname">flexdata.io.</code><code class="descname">write_astra</code><span class="sig-paren">(</span><em>filename</em>, <em>data_shape</em>, <em>meta</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/io.html#write_astra"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.io.write_astra" title="Permalink to this definition">¶</a></dt>
<dd><p>Write an astra-readable projection geometry vector.</p>
</dd></dl>

<dl class="function">
<dt id="flexdata.io.write_image">
<code class="descclassname">flexdata.io.</code><code class="descname">write_image</code><span class="sig-paren">(</span><em>filename</em>, <em>image</em>, <em>compress=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/io.html#write_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.io.write_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a single image. Use compression if needed (0-9).</p>
</dd></dl>

<dl class="function">
<dt id="flexdata.io.write_stack">
<code class="descclassname">flexdata.io.</code><code class="descname">write_stack</code><span class="sig-paren">(</span><em>path</em>, <em>name</em>, <em>data</em>, <em>dim=1</em>, <em>skip=1</em>, <em>dtype=None</em>, <em>zip=False</em>, <em>format='tiff'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/io.html#write_stack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.io.write_stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Write an image stack.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>path (str): destination path
name (str): first part of the files name
data (numpy.array): data to write
dim (int): dimension along which array is separated into images
skip (int): how many images to skip in between
dtype (type): forse this data type   
compress (str): use None, ‘zip’ or ‘jp2’.
format (str): file extension (‘raw’, ‘tiff’, ‘jp2’, etc)</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="flexdata.io.write_tiffs">
<code class="descclassname">flexdata.io.</code><code class="descname">write_tiffs</code><span class="sig-paren">(</span><em>path</em>, <em>name</em>, <em>data</em>, <em>dim=1</em>, <em>skip=1</em>, <em>dtype=None</em>, <em>zip=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/io.html#write_tiffs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.io.write_tiffs" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a tiff stack.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>path (str): destination path
name (str): first part of the files name
data (numpy.array): data to write
dim (int): dimension along which array is separated into images
skip (int): how many images to skip in between
dtype (type): forse this data type   
zip (bool): use loseless zip compression or not.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="flexdata.io.write_toml">
<code class="descclassname">flexdata.io.</code><code class="descname">write_toml</code><span class="sig-paren">(</span><em>filename</em>, <em>meta</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/io.html#write_toml"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.io.write_toml" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a toml file.</p>
</dd></dl>

</div>
<div class="section" id="module-flexdata.scp">
<span id="flexdata-scp-module"></span><h2>flexdata.scp module<a class="headerlink" href="#module-flexdata.scp" title="Permalink to this headline">¶</a></h2>
<p>&#64;author: kostenko
Created on Oct 2018</p>
<p>This module will contain read / write routines to convert FlexRay scanner data into ASTRA compatible data</p>
<dl class="docutils">
<dt>We can now read/write:</dt>
<dd>image files (tiff stacks)
log files from Flex ray (settings.txt)
toml geometry files (metadata.toml)</dd>
</dl>
<p>We can also copy data over SCP!</p>
<dl class="function">
<dt id="flexdata.scp.connect_sftp">
<code class="descclassname">flexdata.scp.</code><code class="descname">connect_sftp</code><span class="sig-paren">(</span><em>hostname</em>, <em>username</em>, <em>password=None</em>, <em>log_file=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/scp.html#connect_sftp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.scp.connect_sftp" title="Permalink to this definition">¶</a></dt>
<dd><p>Make an SFTP connection. Set log_file to a valid filename to dump the log file of the connection.
Returns:</p>
<blockquote>
<div>sftp = _MySFTPClient_</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="flexdata.scp.delete_local">
<code class="descclassname">flexdata.scp.</code><code class="descname">delete_local</code><span class="sig-paren">(</span><em>local_path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/scp.html#delete_local"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.scp.delete_local" title="Permalink to this definition">¶</a></dt>
<dd><p>Often useful to delete a directory recursively. Use with extreme care!</p>
</dd></dl>

<dl class="function">
<dt id="flexdata.scp.ssh_get_path">
<code class="descclassname">flexdata.scp.</code><code class="descname">ssh_get_path</code><span class="sig-paren">(</span><em>local_path</em>, <em>remote_path</em>, <em>hostname</em>, <em>username</em>, <em>password=None</em>, <em>ovewrite='different'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/scp.html#ssh_get_path"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.scp.ssh_get_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy files and directories recursively from remote path to local path.
Set overwrite to:</p>
<blockquote>
<div>‘different’ to overwrite files with a different size;
‘always’ to overwrite all files
‘never’ to never overwrite</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="flexdata.scp.ssh_put_path">
<code class="descclassname">flexdata.scp.</code><code class="descname">ssh_put_path</code><span class="sig-paren">(</span><em>local_path</em>, <em>remote_path</em>, <em>hostname</em>, <em>username</em>, <em>password=None</em>, <em>ovewrite='different'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flexdata/scp.html#ssh_put_path"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flexdata.scp.ssh_put_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy files and directories recursively from local path to remote path.
Set overwrite to:</p>
<blockquote>
<div>‘different’ to overwrite files with a different size;
‘always’ to overwrite all files
‘never’ to never overwrite</div></blockquote>
</dd></dl>

</div>
<div class="section" id="module-flexdata">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-flexdata" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="changelog.html" class="btn btn-neutral float-right" title="Changelog" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="readme.html" class="btn btn-neutral" title="flexDATA" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Author

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'./',
              VERSION:'',
              LANGUAGE:'en',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>